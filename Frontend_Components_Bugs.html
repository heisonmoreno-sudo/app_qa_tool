<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     FRONTEND_COMPONENTS_BUGS.HTML
     Componente para gesti√≥n de bugs
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<style>
    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    /* ESTILOS DE BUGS                                          */
    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

    .bugs-container {
        max-width: 1400px;
        margin: 0 auto;
    }

    /* Badges de severidad */
    .badge-severidad-critica {
        background: #fee2e2;
        color: #991b1b;
        font-weight: 700;
    }

    .badge-severidad-alta {
        background: #fed7aa;
        color: #9a3412;
        font-weight: 600;
    }

    .badge-severidad-media {
        background: #fef3c7;
        color: #92400e;
        font-weight: 600;
    }

    .badge-severidad-baja {
        background: #dbeafe;
        color: #1e40af;
        font-weight: 600;
    }

    /* Badges de estado bug */
    .badge-bug-abierto {
        background: #fee2e2;
        color: #991b1b;
        border: 2px solid #fca5a5;
    }

    .badge-bug-cerrado {
        background: #d1fae5;
        color: #065f46;
        border: 2px solid #6ee7b7;
    }
</style>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- MODAL CREAR/EDITAR BUG                                                      -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div id="modalCrearBug" class="modal-overlay">
    <div
        class="modal"
        style="max-width: 800px; max-height: 90vh; overflow-y: auto"
    >
        <div class="modal-header">
            <h3 class="modal-title">
                <span>üêõ</span>
                <span id="tituloModalBug">Reportar Bug</span>
            </h3>
            <button class="modal-close" onclick="cerrarModalBug()">‚úï</button>
        </div>

        <div class="modal-body">
            <!-- Info del caso relacionado (si aplica) -->
            <div
                id="infoCasoRelacionado"
                class="hidden"
                style="
                    background: #eff6ff;
                    border: 2px solid #3b82f6;
                    border-radius: 8px;
                    padding: 1rem;
                    margin-bottom: 1.5rem;
                "
            >
                <div style="display: flex; align-items: start; gap: 0.75rem">
                    <span style="font-size: 1.5rem">üîó</span>
                    <div style="flex: 1">
                        <strong
                            style="
                                color: #1e40af;
                                display: block;
                                margin-bottom: 0.25rem;
                            "
                        >
                            Bug relacionado con caso de prueba
                        </strong>
                        <div style="color: #1e40af; font-size: 0.9rem">
                            <strong id="casoRelacionadoId"></strong> -
                            <span id="casoRelacionadoTitulo"></span>
                        </div>
                    </div>
                </div>
            </div>

            <form id="formCrearBug" onsubmit="guardarBug(); return false;">
                <input type="hidden" id="bugCasoRelacionado" value="" />
                <input type="hidden" id="bugModoEdicion" value="false" />
                <input type="hidden" id="bugIdEdicion" value="" />

                <!-- CAMPOS OBLIGATORIOS -->
                <div class="form-group">
                    <label class="form-label required"
                        >üêõ T√≠tulo del Bug (10-100 caracteres)</label
                    >
                    <input
                        type="text"
                        id="bugTitulo"
                        class="form-input"
                        required
                        minlength="10"
                        maxlength="100"
                        placeholder="Ej: Error en validaci√≥n de email en formulario de registro"
                    />
                </div>

                <div class="form-group">
                    <label class="form-label required"
                        >üìù Descripci√≥n (m√≠n. 10 caracteres)</label
                    >
                    <textarea
                        id="bugDescripcion"
                        class="form-textarea"
                        required
                        minlength="10"
                        rows="3"
                        placeholder="Describe el bug de forma clara y concisa..."
                    ></textarea>
                </div>

                <div
                    style="
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 1rem;
                    "
                >
                    <div class="form-group">
                        <label class="form-label required">üî¥ Severidad</label>
                        <select id="bugSeveridad" class="form-select" required>
                            <option value="Cr√≠tica">üî¥ Cr√≠tica</option>
                            <option value="Alta">üü† Alta</option>
                            <option value="Media" selected>üü° Media</option>
                            <option value="Baja">üü¢ Baja</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label required">‚ö° Prioridad</label>
                        <select id="bugPrioridad" class="form-select" required>
                            <option value="Alta">‚ö° Alta</option>
                            <option value="Media" selected>üî∏ Media</option>
                            <option value="Baja">üîπ Baja</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label"
                        >‚öôÔ∏è Precondiciones (Opcional)</label
                    >
                    <textarea
                        id="bugPrecondiciones"
                        class="form-textarea"
                        rows="2"
                        placeholder="Ej: Usuario debe estar logueado como administrador"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label"
                        >üß™ Datos de Prueba (Opcional)</label
                    >
                    <textarea
                        id="bugDatosPrueba"
                        class="form-textarea"
                        rows="2"
                        placeholder="Ej: Email: test@test.com, Password: Test123!"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label required"
                        >üë£ Pasos para Reproducir</label
                    >
                    <textarea
                        id="bugPasosReproducir"
                        class="form-textarea"
                        required
                        minlength="10"
                        rows="4"
                        placeholder="1. Ir a la p√°gina de login&#10;2. Ingresar email inv√°lido&#10;3. Click en 'Iniciar Sesi√≥n'&#10;4. Observar el error"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label required"
                        >‚úÖ Resultado Esperado</label
                    >
                    <textarea
                        id="bugResultadoEsperado"
                        class="form-textarea"
                        required
                        minlength="10"
                        rows="2"
                        placeholder="Ej: Debe mostrar mensaje 'Email inv√°lido'"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label required"
                        >‚ùå Resultado Obtenido</label
                    >
                    <textarea
                        id="bugResultadoObtenido"
                        class="form-textarea"
                        required
                        minlength="10"
                        rows="2"
                        placeholder="Ej: Muestra error 500 y la aplicaci√≥n se cuelga"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label required"
                        >üñ•Ô∏è Ambiente/Versi√≥n</label
                    >
                    <input
                        type="text"
                        id="bugAmbiente"
                        class="form-input"
                        required
                        minlength="3"
                        placeholder="Ej: Producci√≥n v2.1.3, QA - Build 456, Dev - Sprint 10"
                    />
                    <p class="form-help">
                        Especifica el ambiente y/o versi√≥n donde ocurre el
                        defecto
                    </p>
                </div>

                <!-- CAMPOS OPCIONALES -->
                <div
                    style="
                        border-top: 2px dashed #e2e8f0;
                        margin: 1.5rem 0;
                        padding-top: 1.5rem;
                    "
                >
                    <h4
                        style="
                            font-size: 1rem;
                            font-weight: 600;
                            color: #475569;
                            margin-bottom: 1rem;
                        "
                    >
                        üìå Informaci√≥n Adicional (Opcional)
                    </h4>

                    <div class="form-group">
                        <label class="form-label">üåê Navegador</label>
                        <select id="bugNavegador" class="form-select">
                            <option value="">Seleccionar...</option>
                            <option value="Chrome">Chrome</option>
                            <option value="Firefox">Firefox</option>
                            <option value="Safari">Safari</option>
                            <option value="Edge">Edge</option>
                            <option value="Otro">Otro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label"
                            >üè∑Ô∏è Etiquetas (separadas por coma)</label
                        >
                        <input
                            type="text"
                            id="bugEtiquetas"
                            class="form-input"
                            placeholder="Ej: login, validaci√≥n, frontend"
                        />
                        <p class="form-help">
                            Las etiquetas se usar√°n en Trello
                        </p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üìù Notas</label>
                        <textarea
                            id="bugNotas"
                            class="form-textarea"
                            rows="2"
                            placeholder="Informaci√≥n adicional, comentarios, etc."
                        ></textarea>
                    </div>
                </div>

                <!-- EVIDENCIAS -->
                <div class="form-group">
                    <label class="form-label">üìé Evidencias</label>

                    <div
                        style="
                            background: #eff6ff;
                            border: 1px solid #3b82f6;
                            border-radius: 6px;
                            padding: 0.75rem;
                            margin-bottom: 1rem;
                            display: flex;
                            align-items: start;
                            gap: 0.5rem;
                        "
                    >
                        <span style="font-size: 1.25rem">üí°</span>
                        <div style="flex: 1; font-size: 0.9rem; color: #1e40af">
                            <strong>Importante:</strong> Los archivos se subir√°n
                            a Drive cuando guardes el bug.
                        </div>
                    </div>

                    <!-- Zona de archivos -->
                    <div style="margin-bottom: 1rem">
                        <div style="font-weight: 600; margin-bottom: 0.5rem">
                            üì§ Subir archivos (m√°x 50MB c/u)
                        </div>
                        <div
                            id="dropzoneBug"
                            class="dropzone-evidencias"
                            ondrop="handleDropBug(event)"
                            ondragover="handleDragOverBug(event)"
                            ondragleave="handleDragLeaveBug(event)"
                            style="cursor: pointer"
                        >
                            <div style="text-align: center; padding: 2rem">
                                <div
                                    style="
                                        font-size: 3rem;
                                        margin-bottom: 0.5rem;
                                    "
                                >
                                    üìÅ
                                </div>
                                <div
                                    style="
                                        font-weight: 600;
                                        margin-bottom: 0.25rem;
                                    "
                                >
                                    Arrastra archivos aqu√≠ o haz click
                                </div>
                                <div style="font-size: 0.85rem; color: #64748b">
                                    PNG, JPG, MP4, PDF (m√°x 50MB)
                                </div>
                            </div>
                        </div>
                        <input
                            type="file"
                            id="inputArchivosBug"
                            multiple
                            accept="image/*,video/*,.pdf"
                            style="display: none"
                            onchange="handleFileSelectBug(event)"
                        />
                    </div>

                    <!-- Lista de evidencias -->
                    <div
                        id="listaEvidenciasBug"
                        class="lista-evidencias hidden"
                    >
                        <div style="font-weight: 600; margin-bottom: 0.5rem">
                            üìã Archivos agregados:
                        </div>
                        <div id="contenidoListaEvidenciasBug"></div>
                    </div>
                </div>

                <!-- INTEGRACI√ìN CON TRELLO -->
                <div
                    style="
                        border-top: 2px solid #0079bf;
                        margin: 1.5rem 0;
                        padding-top: 1.5rem;
                        background: linear-gradient(
                            135deg,
                            #f0f9ff 0%,
                            #e0f2fe 100%
                        );
                        padding: 1.5rem;
                        border-radius: 8px;
                    "
                >
                    <div
                        style="
                            display: flex;
                            align-items: center;
                            justify-content: space-between;
                            margin-bottom: 1rem;
                        "
                    >
                        <h4
                            style="
                                font-size: 1.1rem;
                                font-weight: 700;
                                color: #0079bf;
                                margin: 0;
                            "
                        >
                            üîó Integraci√≥n con Trello
                        </h4>
                        <button
                            type="button"
                            class="btn btn-secondary"
                            onclick="abrirModalConfigTrello()"
                            style="font-size: 0.85rem; padding: 0.4rem 0.8rem"
                        >
                            <span>‚öôÔ∏è</span>
                            <span>Configurar</span>
                        </button>
                    </div>

                    <div
                        id="trelloConfigStatus"
                        style="
                            background: #fef3c7;
                            border-left: 4px solid #f59e0b;
                            padding: 0.75rem;
                            border-radius: 6px;
                            margin-bottom: 1rem;
                        "
                    >
                        <p style="margin: 0; color: #92400e; font-size: 0.9rem">
                            <strong>‚ö†Ô∏è Configuraci√≥n requerida:</strong>
                            Configura tu integraci√≥n con Trello para crear cards
                            autom√°ticamente.
                        </p>
                    </div>

                    <div id="trelloSelectionSection" class="hidden">
                        <div class="form-group">
                            <label class="form-label required"
                                >üìã Tablero de Trello</label
                            >
                            <div
                                style="
                                    display: flex;
                                    gap: 0.5rem;
                                    align-items: center;
                                "
                            >
                                <select
                                    id="bugTrelloBoard"
                                    class="form-select"
                                    onchange="cargarListasTrello()"
                                    style="flex: 1"
                                >
                                    <option value="">
                                        Selecciona un tablero...
                                    </option>
                                </select>
                                <button
                                    type="button"
                                    class="btn btn-secondary"
                                    onclick="cargarTablerosTrello()"
                                    style="
                                        padding: 0.6rem 1rem;
                                        white-space: nowrap;
                                    "
                                >
                                    <span>üîÑ</span>
                                </button>
                            </div>
                            <p class="form-help">
                                Selecciona el tablero donde se crear√° la card
                            </p>
                        </div>

                        <div class="form-group">
                            <label class="form-label required"
                                >üìù Lista (Columna) de Trello</label
                            >
                            <select id="bugTrelloList" class="form-select">
                                <option value="">
                                    Primero selecciona un tablero
                                </option>
                            </select>
                            <p class="form-help">
                                Selecciona la columna donde aparecer√° el bug
                            </p>
                        </div>

                        <div id="trelloEtiquetasSection" class="hidden">
                            <div class="form-group">
                                <label class="form-label"
                                    >üè∑Ô∏è Etiquetas de Trello</label
                                >
                                <div
                                    id="trelloLabelsContainer"
                                    style="
                                        display: flex;
                                        flex-wrap: wrap;
                                        gap: 0.5rem;
                                        padding: 0.75rem;
                                        background: white;
                                        border: 1px solid #e2e8f0;
                                        border-radius: 6px;
                                        min-height: 50px;
                                    "
                                >
                                    <span
                                        style="
                                            color: #94a3b8;
                                            font-size: 0.9rem;
                                        "
                                        >Selecciona un tablero para ver
                                        etiquetas disponibles</span
                                    >
                                </div>
                                <p class="form-help">
                                    Selecciona las etiquetas que se aplicar√°n a
                                    la card (opcional)
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <div class="modal-footer">
            <button
                type="button"
                class="btn btn-primary"
                onclick="guardarBug(); return false;"
            >
                üíæ Crear Bug
            </button>
            <button
                type="button"
                class="btn btn-secondary"
                onclick="cerrarModalBug()"
            >
                Cancelar
            </button>
        </div>
    </div>
</div>

<script>
    // ===================================================================
    // VARIABLES GLOBALES DE BUGS
    // ===================================================================

    (function () {
        console.log("üîµ Iniciando carga de Frontend_Components_Bugs.html");

        if (!window.evidenciasBugTemporales)
            window.evidenciasBugTemporales = [];
        if (!window.bugEnEdicion) window.bugEnEdicion = null;
        console.log("‚úÖ Variables globales de Bugs inicializadas");
    })();

    // ===================================================================
    // ABRIR MODAL CREAR BUG
    // ===================================================================

    function abrirModalCrearBug(casoId) {
        console.log("üêõ Abriendo modal crear bug...");
        console.log("   Caso relacionado:", casoId || "Ninguno (bug manual)");

        const modal = document.getElementById("modalCrearBug");
        const titulo = document.getElementById("tituloModalBug");
        const infoCaso = document.getElementById("infoCasoRelacionado");

        if (!modal) {
            console.error("‚ùå Modal modalCrearBug no encontrado");
            mostrarToast("Error: Modal de bugs no disponible", "error");
            return;
        }

        // Limpiar campos manualmente (sin usar form.reset)
        document.getElementById("bugTitulo").value = "";
        document.getElementById("bugDescripcion").value = "";
        document.getElementById("bugSeveridad").value = "Media";
        document.getElementById("bugPrioridad").value = "Media";
        document.getElementById("bugPrecondiciones").value = "";
        document.getElementById("bugDatosPrueba").value = "";
        document.getElementById("bugPasosReproducir").value = "";
        document.getElementById("bugResultadoEsperado").value = "";
        document.getElementById("bugResultadoObtenido").value = "";
        document.getElementById("bugAmbiente").value = "";
        document.getElementById("bugNavegador").value = "";
        document.getElementById("bugEtiquetas").value = "";
        document.getElementById("bugNotas").value = "";

        const modoEdicion = document.getElementById("bugModoEdicion");
        const idEdicion = document.getElementById("bugIdEdicion");
        const casoRelacionadoInput =
            document.getElementById("bugCasoRelacionado");

        if (modoEdicion) modoEdicion.value = "false";
        if (idEdicion) idEdicion.value = "";

        window.evidenciasBugTemporales = [];
        const listaEvidencias = document.getElementById("listaEvidenciasBug");
        const contenidoLista = document.getElementById(
            "contenidoListaEvidenciasBug"
        );

        if (listaEvidencias) listaEvidencias.classList.add("hidden");
        if (contenidoLista) contenidoLista.innerHTML = "";

        if (titulo) {
            titulo.textContent = casoId
                ? "Reportar Bug desde Caso"
                : "Reportar Bug";
        }

        if (casoId) {
            const caso = window.casosActuales
                ? window.casosActuales.find((c) => c.ID === casoId)
                : null;

            if (caso) {
                if (casoRelacionadoInput) casoRelacionadoInput.value = casoId;

                const casoIdSpan = document.getElementById("casoRelacionadoId");
                const casoTituloSpan = document.getElementById(
                    "casoRelacionadoTitulo"
                );

                if (casoIdSpan) casoIdSpan.textContent = casoId;
                if (casoTituloSpan)
                    casoTituloSpan.textContent = caso.Titulo || "";
                if (infoCaso) infoCaso.classList.remove("hidden");

                preLlenarDesdeCaso(caso);
            } else {
                console.warn("‚ö†Ô∏è Caso no encontrado en casosActuales:", casoId);
            }
        } else {
            if (casoRelacionadoInput) casoRelacionadoInput.value = "";
            if (infoCaso) infoCaso.classList.add("hidden");
        }

        // Verificar estado de Trello
        verificarEstadoTrelloEnModal();

        if (typeof abrirModal === "function") {
            abrirModal("modalCrearBug");
        } else {
            console.error("‚ùå Funci√≥n abrirModal no disponible");
            modal.classList.add("active");
            document.body.style.overflow = "hidden";
        }
    }

    function preLlenarDesdeCaso(caso) {
        console.log("üìù Pre-llenando formulario desde caso...");

        const tituloSugerido =
            "Error en: " + (caso.Titulo || "").substring(0, 80);
        document.getElementById("bugTitulo").value = tituloSugerido;

        let descripcionBase =
            "Bug detectado durante la ejecuci√≥n del caso de prueba.\n\n";
        descripcionBase += "Caso: " + caso.ID + " - " + caso.Titulo;
        document.getElementById("bugDescripcion").value = descripcionBase;

        if (caso.Prioridad === "Critica" || caso.FlujoCritico === "Si") {
            document.getElementById("bugSeveridad").value = "Cr√≠tica";
            document.getElementById("bugPrioridad").value = "Alta";
        } else if (caso.Prioridad === "Alta") {
            document.getElementById("bugSeveridad").value = "Alta";
            document.getElementById("bugPrioridad").value = "Alta";
        } else {
            document.getElementById("bugSeveridad").value = "Media";
            document.getElementById("bugPrioridad").value = "Media";
        }

        if (caso.Precondiciones && caso.Precondiciones !== "") {
            document.getElementById("bugPrecondiciones").value =
                caso.Precondiciones;
        } else {
            document.getElementById("bugPrecondiciones").value =
                "Condiciones previas necesarias...";
        }

        if (caso.Formato === "Gherkin") {
            let pasos = "";
            if (caso.ScenarioGiven)
                pasos += "Dado: " + caso.ScenarioGiven + "\n";
            if (caso.ScenarioWhen)
                pasos += "Cuando: " + caso.ScenarioWhen + "\n";
            if (caso.ScenarioThen) pasos += "Entonces: " + caso.ScenarioThen;
            document.getElementById("bugPasosReproducir").value =
                pasos || "1. Paso uno\n2. Paso dos\n3. Paso tres";
        } else {
            if (caso.Pasos && caso.Pasos !== "") {
                document.getElementById("bugPasosReproducir").value =
                    caso.Pasos;
            } else {
                document.getElementById("bugPasosReproducir").value =
                    "1. Paso uno\n2. Paso dos\n3. Paso tres";
            }
        }

        if (caso.ResultadoEsperado && caso.ResultadoEsperado !== "") {
            document.getElementById("bugResultadoEsperado").value =
                caso.ResultadoEsperado;
        } else {
            document.getElementById("bugResultadoEsperado").value =
                "Describe el resultado esperado...";
        }

        document.getElementById("bugResultadoObtenido").value =
            "Describe aqu√≠ el comportamiento err√≥neo observado...";
        document.getElementById("bugDatosPrueba").value =
            "Indica los datos usados en la prueba que caus√≥ el error";

        console.log("‚úÖ Formulario pre-llenado");
    }

    function cerrarModalBug() {
        cerrarModal("modalCrearBug");
    }

    // ===================================================================
    // INTEGRACI√ìN CON TRELLO
    // ===================================================================

    // Variables globales para Trello
    if (!window.trelloBoardsData) window.trelloBoardsData = [];
    if (!window.trelloListsData) window.trelloListsData = [];
    if (!window.trelloLabelsData) window.trelloLabelsData = [];
    if (!window.trelloSelectedLabels) window.trelloSelectedLabels = [];

    /**
     * Verifica el estado de Trello al abrir el modal
     */
    function verificarEstadoTrelloEnModal() {
        console.log("üîç Verificando estado de Trello...");

        google.script.run
            .withSuccessHandler(function (response) {
                if (response.success && response.configurado) {
                    console.log("‚úÖ Trello configurado");

                    // Ocultar mensaje de configuraci√≥n requerida
                    const statusDiv =
                        document.getElementById("trelloConfigStatus");
                    if (statusDiv) {
                        statusDiv.innerHTML = `
              <p style="margin: 0; color: #065f46; font-size: 0.9rem;">
                <strong>‚úÖ Conectado:</strong> ${response.usuario || "Trello"}
              </p>
            `;
                        statusDiv.style.background = "#d1fae5";
                        statusDiv.style.borderColor = "#10b981";
                    }

                    // Mostrar secci√≥n de selecci√≥n
                    const selectionSection = document.getElementById(
                        "trelloSelectionSection"
                    );
                    if (selectionSection) {
                        selectionSection.classList.remove("hidden");
                    }

                    // Cargar tableros autom√°ticamente
                    cargarTablerosTrello();
                } else {
                    console.log("‚ö†Ô∏è Trello no configurado");
                    // Mantener mensaje de configuraci√≥n requerida visible
                }
            })
            .withFailureHandler(function (error) {
                console.error("Error verificando Trello:", error);
            })
            .verificarCredencialesTrello();
    }

    /**
     * Carga los tableros de Trello
     */
    function cargarTablerosTrello() {
        console.log("üìã Cargando tableros de Trello...");

        const selectBoard = document.getElementById("bugTrelloBoard");
        if (!selectBoard) {
            console.error("Select de tableros no encontrado");
            return;
        }

        // Mostrar loading
        selectBoard.innerHTML =
            '<option value="">Cargando tableros...</option>';
        selectBoard.disabled = true;

        google.script.run
            .withSuccessHandler(function (response) {
                selectBoard.disabled = false;

                if (response.success && response.data) {
                    window.trelloBoardsData = response.data;

                    selectBoard.innerHTML =
                        '<option value="">Selecciona un tablero...</option>';

                    response.data.forEach(function (board) {
                        const option = document.createElement("option");
                        option.value = board.id;
                        option.textContent = board.name;
                        selectBoard.appendChild(option);
                    });

                    console.log("‚úÖ Tableros cargados:", response.data.length);
                    mostrarToast(
                        "Tableros cargados: " + response.data.length,
                        "success"
                    );
                } else {
                    selectBoard.innerHTML =
                        '<option value="">Error al cargar tableros</option>';
                    mostrarToast(
                        "‚ùå " +
                            (response.mensaje || "Error al cargar tableros"),
                        "error"
                    );
                }
            })
            .withFailureHandler(function (error) {
                selectBoard.disabled = false;
                selectBoard.innerHTML =
                    '<option value="">Error al cargar</option>';
                console.error("Error cargando tableros:", error);
                mostrarToast(
                    "Error al cargar tableros: " + error.message,
                    "error"
                );
            })
            .listarTablerosTrello();
    }

    /**
     * Carga las listas del tablero seleccionado
     */
    function cargarListasTrello() {
        const selectBoard = document.getElementById("bugTrelloBoard");
        const selectList = document.getElementById("bugTrelloList");

        if (!selectBoard || !selectList) {
            console.error("Selects no encontrados");
            return;
        }

        const boardId = selectBoard.value;

        if (!boardId) {
            selectList.innerHTML =
                '<option value="">Primero selecciona un tablero</option>';
            selectList.disabled = true;

            // Ocultar etiquetas
            const etiquetasSection = document.getElementById(
                "trelloEtiquetasSection"
            );
            if (etiquetasSection) etiquetasSection.classList.add("hidden");

            return;
        }

        console.log("üìù Cargando listas del tablero:", boardId);

        selectList.innerHTML = '<option value="">Cargando listas...</option>';
        selectList.disabled = true;

        // Cargar listas
        google.script.run
            .withSuccessHandler(function (response) {
                selectList.disabled = false;

                if (response.success && response.data) {
                    window.trelloListsData = response.data;

                    selectList.innerHTML =
                        '<option value="">Selecciona una lista...</option>';

                    response.data.forEach(function (list) {
                        const option = document.createElement("option");
                        option.value = list.id;
                        option.textContent = list.name;
                        selectList.appendChild(option);
                    });

                    console.log("‚úÖ Listas cargadas:", response.data.length);
                } else {
                    selectList.innerHTML =
                        '<option value="">Error al cargar listas</option>';
                    mostrarToast(
                        "‚ùå " + (response.mensaje || "Error al cargar listas"),
                        "error"
                    );
                }
            })
            .withFailureHandler(function (error) {
                selectList.disabled = false;
                selectList.innerHTML =
                    '<option value="">Error al cargar</option>';
                console.error("Error cargando listas:", error);
                mostrarToast(
                    "Error al cargar listas: " + error.message,
                    "error"
                );
            })
            .listarListasTrello(boardId);

        // Cargar etiquetas del tablero
        cargarEtiquetasTrello(boardId);
    }

    /**
     * Carga las etiquetas del tablero
     */
    function cargarEtiquetasTrello(boardId) {
        console.log("üè∑Ô∏è Cargando etiquetas del tablero:", boardId);

        google.script.run
            .withSuccessHandler(function (response) {
                if (response.success && response.data) {
                    window.trelloLabelsData = response.data;
                    window.trelloSelectedLabels = [];

                    const container = document.getElementById(
                        "trelloLabelsContainer"
                    );
                    const section = document.getElementById(
                        "trelloEtiquetasSection"
                    );

                    if (!container || !section) return;

                    // Mostrar secci√≥n
                    section.classList.remove("hidden");

                    // Renderizar etiquetas
                    container.innerHTML = "";

                    if (response.data.length === 0) {
                        container.innerHTML =
                            '<span style="color: #94a3b8; font-size: 0.9rem;">No hay etiquetas en este tablero</span>';
                        return;
                    }

                    response.data.forEach(function (label) {
                        const labelDiv = document.createElement("div");
                        labelDiv.style.cssText =
                            "display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.4rem 0.8rem; border-radius: 16px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s; font-size: 0.9rem; font-weight: 500;";
                        labelDiv.style.backgroundColor = getTrelloColorHex(
                            label.color
                        );
                        labelDiv.style.color = "#fff";
                        labelDiv.textContent =
                            label.name || label.color || "Sin nombre";
                        labelDiv.dataset.labelId = label.id;

                        labelDiv.onclick = function () {
                            toggleTrelloLabel(label.id, labelDiv);
                        };

                        container.appendChild(labelDiv);
                    });

                    console.log("‚úÖ Etiquetas cargadas:", response.data.length);
                } else {
                    console.error(
                        "Error cargando etiquetas:",
                        response.mensaje
                    );
                }
            })
            .withFailureHandler(function (error) {
                console.error("Error cargando etiquetas:", error);
            })
            .listarEtiquetasTrello(boardId);
    }

    /**
     * Toggle selecci√≥n de etiqueta
     */
    function toggleTrelloLabel(labelId, element) {
        const index = window.trelloSelectedLabels.indexOf(labelId);

        if (index > -1) {
            // Deseleccionar
            window.trelloSelectedLabels.splice(index, 1);
            element.style.border = "2px solid transparent";
            element.style.transform = "scale(1)";
        } else {
            // Seleccionar
            window.trelloSelectedLabels.push(labelId);
            element.style.border = "2px solid #1e293b";
            element.style.transform = "scale(1.05)";
        }

        console.log("Etiquetas seleccionadas:", window.trelloSelectedLabels);
    }

    /**
     * Convierte colores de Trello a HEX
     */
    function getTrelloColorHex(color) {
        const colors = {
            green: "#61bd4f",
            yellow: "#f2d600",
            orange: "#ff9f1a",
            red: "#eb5a46",
            purple: "#c377e0",
            blue: "#0079bf",
            sky: "#00c2e0",
            lime: "#51e898",
            pink: "#ff78cb",
            black: "#344563",
            green_dark: "#519839",
            yellow_dark: "#d9b51c",
            orange_dark: "#cd8313",
            red_dark: "#b04632",
            purple_dark: "#89609e",
            blue_dark: "#055a8c",
            sky_dark: "#0098b7",
            lime_dark: "#4ed583",
            pink_dark: "#e568af",
            black_dark: "#091e42",
        };

        return colors[color] || "#94a3b8";
    }

    // ===================================================================
    // MANEJO DE EVIDENCIAS
    // ===================================================================

    function handleDragOverBug(event) {
        event.preventDefault();
        event.stopPropagation();
        document.getElementById("dropzoneBug").classList.add("drag-over");
    }

    function handleDragLeaveBug(event) {
        event.preventDefault();
        event.stopPropagation();
        document.getElementById("dropzoneBug").classList.remove("drag-over");
    }

    function handleDropBug(event) {
        event.preventDefault();
        event.stopPropagation();
        document.getElementById("dropzoneBug").classList.remove("drag-over");

        const files = event.dataTransfer.files;
        procesarArchivosBug(files);
    }

    function handleFileSelectBug(event) {
        const files = event.target.files;
        procesarArchivosBug(files);
        event.target.value = "";
    }

    // Click en dropzone
    document.addEventListener("DOMContentLoaded", function () {
        const dropzone = document.getElementById("dropzoneBug");
        if (dropzone) {
            dropzone.addEventListener("click", function () {
                document.getElementById("inputArchivosBug").click();
            });
        }
    });

    function procesarArchivosBug(files) {
        let archivosValidos = 0;

        for (let i = 0; i < files.length; i++) {
            const file = files[i];

            if (file.size > 50 * 1024 * 1024) {
                mostrarToast(
                    '‚ùå "' + file.name + '" excede los 50 MB',
                    "error",
                    4000
                );
                continue;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
                window.evidenciasBugTemporales.push({
                    tipo: "archivo",
                    nombre: file.name,
                    tama√±o: file.size,
                    mimeType: file.type,
                    contenidoBase64: e.target.result.split(",")[1],
                });

                renderizarListaEvidenciasBug();

                const tama√±oMB = (file.size / (1024 * 1024)).toFixed(2);
                mostrarToast(
                    '‚úÖ "' + file.name + '" listo (' + tama√±oMB + " MB)",
                    "success",
                    2000
                );
            };

            reader.onerror = function () {
                mostrarToast('‚ùå Error leyendo "' + file.name + '"', "error");
            };

            reader.readAsDataURL(file);
            archivosValidos++;
        }

        if (files.length > 1) {
            setTimeout(() => {
                if (archivosValidos > 0) {
                    mostrarToast(
                        "üìé " + archivosValidos + " archivo(s) agregado(s)",
                        "info",
                        2000
                    );
                }
            }, 500);
        }
    }

    function renderizarListaEvidenciasBug() {
        const lista = document.getElementById("listaEvidenciasBug");
        const contenido = document.getElementById(
            "contenidoListaEvidenciasBug"
        );

        if (window.evidenciasBugTemporales.length === 0) {
            lista.classList.add("hidden");
            return;
        }

        lista.classList.remove("hidden");

        let html = "";
        window.evidenciasBugTemporales.forEach((evidencia, index) => {
            const tama√±oMB = (evidencia.tama√±o / (1024 * 1024)).toFixed(2);

            html += '<div class="evidencia-item">';
            html +=
                '  <div style="display: flex; align-items: center; gap: 0.5rem; flex: 1;">';
            html += '    <span style="font-size: 1.5rem;">üìé</span>';
            html += '    <div style="flex: 1;">';
            html +=
                '      <div style="font-weight: 500; word-break: break-word;">' +
                evidencia.nombre +
                "</div>";
            html +=
                '      <div style="font-size: 0.85rem; color: #64748b;">' +
                tama√±oMB +
                " MB</div>";
            html += "    </div>";
            html += "  </div>";
            html +=
                '  <button type="button" class="btn-eliminar-evidencia" onclick="eliminarEvidenciaBug(' +
                index +
                ')" title="Eliminar">üóëÔ∏è</button>';
            html += "</div>";
        });

        contenido.innerHTML = html;
    }

    function eliminarEvidenciaBug(index) {
        window.evidenciasBugTemporales.splice(index, 1);
        renderizarListaEvidenciasBug();
        mostrarToast("‚úÖ Evidencia eliminada", "success");
    }

    // ===================================================================
    // GUARDAR BUG
    // ===================================================================

    async function guardarBug() {
        console.log("üíæ Guardando bug...");

        // ===================================================================
        // VALIDACIONES DE CAMPOS OBLIGATORIOS
        // ===================================================================

        const titulo = document.getElementById("bugTitulo").value.trim();
        const descripcion = document
            .getElementById("bugDescripcion")
            .value.trim();
        const precondiciones = document
            .getElementById("bugPrecondiciones")
            .value.trim();
        const datosPrueba = document
            .getElementById("bugDatosPrueba")
            .value.trim();
        const pasosReproducir = document
            .getElementById("bugPasosReproducir")
            .value.trim();
        const resultadoEsperado = document
            .getElementById("bugResultadoEsperado")
            .value.trim();
        const resultadoObtenido = document
            .getElementById("bugResultadoObtenido")
            .value.trim();
        const ambiente = document.getElementById("bugAmbiente").value.trim();

        // Campos mandatorios
        if (!titulo || titulo.length < 10) {
            mostrarToast(
                "‚ö†Ô∏è El t√≠tulo debe tener al menos 10 caracteres",
                "warning"
            );
            document.getElementById("bugTitulo").focus();
            return;
        }

        if (!descripcion || descripcion.length < 10) {
            mostrarToast(
                "‚ö†Ô∏è La descripci√≥n (Resumen del defecto) debe tener al menos 10 caracteres",
                "warning"
            );
            document.getElementById("bugDescripcion").focus();
            return;
        }

        if (!pasosReproducir || pasosReproducir.length < 10) {
            mostrarToast(
                "‚ö†Ô∏è Los pasos para reproducir son obligatorios (m√≠n. 10 caracteres)",
                "warning"
            );
            document.getElementById("bugPasosReproducir").focus();
            return;
        }

        if (!resultadoEsperado || resultadoEsperado.length < 10) {
            mostrarToast(
                "‚ö†Ô∏è El resultado esperado es obligatorio (m√≠n. 10 caracteres)",
                "warning"
            );
            document.getElementById("bugResultadoEsperado").focus();
            return;
        }

        if (!resultadoObtenido || resultadoObtenido.length < 10) {
            mostrarToast(
                "‚ö†Ô∏è El resultado obtenido es obligatorio (m√≠n. 10 caracteres)",
                "warning"
            );
            document.getElementById("bugResultadoObtenido").focus();
            return;
        }

        if (!ambiente || ambiente.length < 3) {
            mostrarToast(
                "‚ö†Ô∏è El ambiente/versi√≥n es obligatorio (m√≠n. 3 caracteres)",
                "warning"
            );
            document.getElementById("bugAmbiente").focus();
            return;
        }

        console.log("‚úÖ Validaciones b√°sicas OK");

        // ===================================================================
        // PREPARAR DATOS DEL BUG
        // ===================================================================

        const sheetUrl = window.currentSheetUrl;

        if (!sheetUrl) {
            console.error("‚ùå No hay currentSheetUrl disponible");
            console.log("window.currentSheetUrl:", window.currentSheetUrl);
            mostrarToast(
                "‚ùå Error: No hay Sheet conectado. Recarga la p√°gina e intenta de nuevo.",
                "error"
            );
            return;
        }

        console.log("‚úÖ Sheet URL obtenida:", sheetUrl);

        const casoRelacionado = document
            .getElementById("bugCasoRelacionado")
            .value.trim();

        const datosBug = {
            sheetUrl: sheetUrl,
            titulo: titulo,
            descripcion: descripcion,
            severidad: document.getElementById("bugSeveridad").value,
            prioridad: document.getElementById("bugPrioridad").value,
            precondiciones: precondiciones,
            datosPrueba: datosPrueba,
            pasosReproducir: pasosReproducir,
            resultadoEsperado: resultadoEsperado,
            resultadoObtenido: resultadoObtenido,
            ambiente: document.getElementById("bugAmbiente").value,
            navegador: document.getElementById("bugNavegador").value,
            etiquetas: document.getElementById("bugEtiquetas").value,
            notas: document.getElementById("bugNotas").value,
            tieneCasoDise√±ado: casoRelacionado ? true : false,
            casosRelacionados: casoRelacionado || "",
            origenSinCaso: casoRelacionado ? "" : "Manual",
            evidencias: [],
        };

        // Agregar evidencias si hay
        if (
            window.evidenciasBugTemporales &&
            window.evidenciasBugTemporales.length > 0
        ) {
            // Por ahora solo guardamos los nombres (la subida a Drive es para despu√©s)
            datosBug.evidencias = window.evidenciasBugTemporales.map(
                (e) => e.nombre
            );
        }

        console.log("üì¶ Datos del bug:", datosBug);

        // ===================================================================
        // LLAMAR AL BACKEND
        // ===================================================================

        mostrarSpinner();

        google.script.run
            .withSuccessHandler(function (response) {
                console.log("üì® Respuesta del backend:", response);

                if (response.success) {
                    const bugId = response.data.bugId;

                    console.log("‚úÖ Bug " + bugId + " creado en Sheets");

                    // Intentar crear card en Trello si est√° configurado
                    const trelloListId =
                        document.getElementById("bugTrelloList").value;

                    if (trelloListId) {
                        console.log("üîó Creando card en Trello...");
                        mostrarSpinner("Creando card en Trello...");

                        // Preparar datos para Trello con el bugId generado
                        const datosBugConId = Object.assign({}, datosBug, {
                            id: bugId,
                        });

                        google.script.run
                            .withSuccessHandler(function (trelloResponse) {
                                ocultarSpinner();

                                if (trelloResponse.success) {
                                    console.log(
                                        "‚úÖ Card de Trello creada:",
                                        trelloResponse.data.cardUrl
                                    );
                                    mostrarToast(
                                        "‚úÖ Bug " +
                                            bugId +
                                            " creado y enviado a Trello!",
                                        "success"
                                    );

                                    // TODO: Actualizar el bug en Sheets con la URL de Trello
                                    // (esto requerir√≠a otra funci√≥n en el backend)
                                } else {
                                    console.error(
                                        "‚ùå Error creando card en Trello:",
                                        trelloResponse.mensaje
                                    );
                                    mostrarToast(
                                        "‚ö†Ô∏è Bug " +
                                            bugId +
                                            " creado, pero fall√≥ Trello: " +
                                            trelloResponse.mensaje,
                                        "warning"
                                    );
                                }

                                // Continuar con el flujo normal
                                finalizarCreacionBug(bugId, casoRelacionado);
                            })
                            .withFailureHandler(function (error) {
                                ocultarSpinner();
                                console.error(
                                    "üí• Error en integraci√≥n Trello:",
                                    error
                                );
                                mostrarToast(
                                    "‚ö†Ô∏è Bug " +
                                        bugId +
                                        " creado, pero fall√≥ Trello: " +
                                        error.message,
                                    "warning"
                                );

                                // Continuar con el flujo normal
                                finalizarCreacionBug(bugId, casoRelacionado);
                            })
                            .crearCardTrello(
                                datosBugConId,
                                trelloListId,
                                window.trelloSelectedLabels || []
                            );
                    } else {
                        // No hay Trello configurado, continuar normalmente
                        ocultarSpinner();
                        mostrarToast(
                            "‚úÖ Bug " + bugId + " creado exitosamente",
                            "success"
                        );
                        finalizarCreacionBug(bugId, casoRelacionado);
                    }
                } else {
                    ocultarSpinner();
                    mostrarToast("‚ùå Error: " + response.mensaje, "error");
                }
            })
            .withFailureHandler(function (error) {
                ocultarSpinner();
                console.error("üí• Error llamando al backend:", error);
                mostrarToast("Error al crear bug: " + error.message, "error");
            })
            .crearBug(datosBug);
    }

    /**
     * Finaliza el proceso de creaci√≥n de bug (limpia form, cierra modal, etc.)
     */
    function finalizarCreacionBug(bugId, casoRelacionado) {
        console.log("üèÅ Finalizando creaci√≥n de bug:", bugId);

        // Limpiar formulario manualmente
        document.getElementById("bugTitulo").value = "";
        document.getElementById("bugDescripcion").value = "";
        window.evidenciasBugTemporales = [];

        // Cerrar modal de bugs
        cerrarModalBug();

        // Marcar bug creado recientemente para el caso (para permitir guardar No_OK sin revalidar)
        try {
            window.__ultimoBugCreado = {
                bugId: bugId,
                casoId: casoRelacionado || null,
                at: Date.now(),
            };
        } catch (e) {}

        // Si el modal de ejecuci√≥n est√° abierto para este caso, preparar No_OK y guardar autom√°ticamente
        try {
            if (
                window.casoEnEjecucion &&
                casoRelacionado &&
                window.casoEnEjecucion.ID === casoRelacionado
            ) {
                // Setear resultado en UI
                const resInput = document.getElementById("resultadoEjecucion");
                if (resInput) resInput.value = "No_OK";
                if (typeof seleccionarResultado === "function")
                    seleccionarResultado("No_OK");

                // Agregar referencia al bug en observaciones (si no est√°)
                const obs = document.getElementById("ejecucionComentarios");
                if (obs && obs.value.indexOf(bugId) === -1) {
                    obs.value =
                        (obs.value ? obs.value + "\n" : "") +
                        "Bug reportado: " +
                        bugId;
                }

                // Guardar ejecuci√≥n autom√°ticamente
                if (typeof guardarEjecucion === "function") {
                    setTimeout(function () {
                        guardarEjecucion();
                    }, 400);
                }
            }
        } catch (e) {
            console.warn("No se pudo sincronizar con modal de ejecuci√≥n:", e);
        }

        // Si est√°bamos en modal de ejecuci√≥n, actualizar estado
        if (casoRelacionado) {
            mostrarToast(
                "Bug " + bugId + " vinculado al caso " + casoRelacionado,
                "info",
                2000
            );
        }

        // Si hay tabla de casos visible, recargarla
        if (typeof cargarTodosLosCasos === "function") {
            setTimeout(() => {
                cargarTodosLosCasos();
            }, 500);
        }
    }

    // ===================================================================
    // EXPORTAR AL SCOPE GLOBAL
    // ===================================================================

    window.abrirModalCrearBug = abrirModalCrearBug;
    window.cerrarModalBug = cerrarModalBug;
    window.preLlenarDesdeCaso = preLlenarDesdeCaso;
    window.handleDragOverBug = handleDragOverBug;
    window.handleDragLeaveBug = handleDragLeaveBug;
    window.handleDropBug = handleDropBug;
    window.handleFileSelectBug = handleFileSelectBug;
    window.procesarArchivosBug = procesarArchivosBug;
    window.renderizarListaEvidenciasBug = renderizarListaEvidenciasBug;
    window.eliminarEvidenciaBug = eliminarEvidenciaBug;
    window.guardarBug = guardarBug;

    console.log("‚úÖ Frontend_Components_Bugs.html cargado correctamente");
</script>

<!DOCTYPE html>
<html>
    <head>
        <base target="_top" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>QA Management System</title>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- ESTILOS GLOBALES                                                     -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <?!= include('Frontend_Styles_Base'); ?>
    </head>

    <body>
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- HEADER                                                               -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <span>üìä</span>
                    <span>QA Management System</span>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">?</div>
                    <span id="userEmail">Cargando...</span>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- CONTENEDOR PRINCIPAL                                                 -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="container">
            <!-- Pantalla de Bienvenida -->
            <div id="welcomeScreen" class="welcome-screen">
                <div class="card" style="max-width: 700px; margin: 0 auto">
                    <div class="welcome-icon">üìä</div>
                    <h1 class="welcome-title">Bienvenido a QA Management</h1>
                    <p class="welcome-subtitle">
                        Sistema integral para gesti√≥n de casos de prueba, bugs y
                        regresiones
                    </p>

                    <div style="max-width: 500px; margin: 0 auto">
                        <!-- Input para URL del Google Sheet -->
                        <div class="mb-2">
                            <label
                                style="
                                    display: block;
                                    margin-bottom: 0.5rem;
                                    font-weight: 600;
                                    color: #475569;
                                "
                            >
                                üìÑ URL de tu Google Sheet:
                            </label>
                            <input
                                type="text"
                                id="sheetUrlInput"
                                class="input-field"
                                placeholder="https://docs.google.com/spreadsheets/d/..."
                                style="
                                    width: 100%;
                                    padding: 0.75rem;
                                    border: 1px solid #e2e8f0;
                                    border-radius: 8px;
                                "
                            />
                            <p
                                style="
                                    font-size: 0.85rem;
                                    color: #64748b;
                                    margin-top: 0.5rem;
                                "
                            >
                                Pega aqu√≠ la URL de tu Google Sheet de pruebas
                            </p>
                        </div>

                        <button
                            class="btn btn-primary btn-block"
                            onclick="irACasos()"
                        >
                            <span>üìã</span>
                            <span>Conectar a mi Sheet</span>
                        </button>

                        <button
                            class="btn btn-secondary btn-block"
                            onclick="iniciarCreacionWorkspace()"
                        >
                            <span>‚ú®</span>
                            <span>Crear Nuevo Workspace</span>
                        </button>

                        <!-- Secci√≥n de M√©tricas -->
                        <div
                            style="
                                border-top: 1px solid #e2e8f0;
                                margin: 1.5rem 0;
                                padding-top: 1.5rem;
                            "
                        >
                            <p
                                style="
                                    font-weight: 600;
                                    color: var(--text-primary);
                                    margin-bottom: 0.75rem;
                                    text-align: center;
                                "
                            >
                                üìä M√©tricas y An√°lisis
                            </p>

                            <div
                                style="
                                    display: grid;
                                    grid-template-columns: 1fr 1fr;
                                    gap: 0.75rem;
                                "
                            >
                                <button
                                    class="btn btn-secondary"
                                    onclick="mostrarMetricasProyecto()"
                                    style="font-size: 0.9rem"
                                >
                                    <span>üìä</span>
                                    <span>M√©tricas del Proyecto</span>
                                </button>

                                <button
                                    class="btn btn-secondary"
                                    onclick="mostrarMetricasQA()"
                                    style="font-size: 0.9rem"
                                >
                                    <span>üë©‚Äçüíª</span>
                                    <span>M√©tricas por QA</span>
                                </button>
                            </div>
                        </div>

                        <div
                            style="
                                border-top: 1px solid #e2e8f0;
                                margin: 1.5rem 0;
                                padding-top: 1.5rem;
                            "
                        >
                            <p
                                style="
                                    font-weight: 600;
                                    color: var(--text-primary);
                                    margin-bottom: 0.75rem;
                                    text-align: center;
                                "
                            >
                                üîó Integraciones
                            </p>

                            <button
                                class="btn btn-secondary btn-block"
                                onclick="abrirModalConfigTrello()"
                                style="
                                    background: linear-gradient(
                                        135deg,
                                        #0079bf 0%,
                                        #026aa7 100%
                                    );
                                    color: white;
                                    border: none;
                                "
                            >
                                <span>üîó</span>
                                <span>Configurar Integraci√≥n con Trello</span>
                            </button>
                        </div>

                        <div
                            style="
                                border-top: 1px solid #e2e8f0;
                                margin: 1.5rem 0;
                                padding-top: 1.5rem;
                            "
                        >
                            <button
                                class="btn btn-secondary btn-block"
                                onclick="testearBackend()"
                            >
                                <span>üöÄ</span>
                                <span>Probar Conexi√≥n Backend</span>
                            </button>

                            <button
                                class="btn btn-secondary btn-block"
                                onclick="mostrarInfo()"
                            >
                                <span>üìö</span>
                                <span>Ver Gu√≠a de Inicio</span>
                            </button>
                        </div>

                        <p
                            class="mt-2"
                            style="
                                color: #64748b;
                                font-size: 0.9rem;
                                text-align: center;
                            "
                        >
                            Sprint 3: Arquitectura Modular Implementada ‚ú®
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- OVERLAY DE CARGA                                                     -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="loading-content">
                <div class="spinner"></div>
                <div class="loading-message" id="loadingMessage">
                    Cargando...
                </div>
                <div class="loading-tip" id="loadingTip">
                    Preparando tu arsenal de testing...
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- NOTIFICACI√ìN                                                         -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="notification" class="notification">
            <span id="notificationIcon">‚úì</span>
            <span id="notificationMessage">Mensaje</span>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- MODAL: GU√çA DE INICIO / ONBOARDING                                   -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="modalGuiaInicio" class="modal-overlay">
            <div
                class="modal"
                style="max-width: 900px; max-height: 85vh; overflow-y: auto"
            >
                <div class="modal-header">
                    <h3 class="modal-title">
                        <span>üìö</span>
                        <span>Gu√≠a de Inicio - QA Management System</span>
                    </h3>
                    <button
                        class="modal-close"
                        onclick="cerrarModal('modalGuiaInicio')"
                    >
                        ‚úï
                    </button>
                </div>

                <div class="modal-body">
                    <!-- Introducci√≥n -->
                    <div
                        style="
                            background: linear-gradient(
                                135deg,
                                #eff6ff 0%,
                                #dbeafe 100%
                            );
                            padding: 1.5rem;
                            border-radius: 8px;
                            border-left: 4px solid #3b82f6;
                            margin-bottom: 2rem;
                        "
                    >
                        <h4
                            style="
                                margin: 0 0 0.75rem 0;
                                color: #1e40af;
                                font-size: 1.1rem;
                            "
                        >
                            üëã Bienvenido a tu Sistema de Gesti√≥n QA
                        </h4>
                        <p style="margin: 0; color: #1e40af; line-height: 1.6">
                            Esta plataforma te permite gestionar casos de
                            prueba, ejecutar tests, reportar bugs y analizar
                            m√©tricas del proyecto. Todo respaldado por Google
                            Sheets como base de datos.
                        </p>
                    </div>

                    <!-- Paso 1 -->
                    <div style="margin-bottom: 2rem">
                        <h4
                            style="
                                font-size: 1.1rem;
                                font-weight: 700;
                                color: #1e293b;
                                margin-bottom: 1rem;
                                display: flex;
                                align-items: center;
                                gap: 0.5rem;
                            "
                        >
                            <span
                                style="
                                    background: #3b82f6;
                                    color: white;
                                    width: 28px;
                                    height: 28px;
                                    border-radius: 50%;
                                    display: inline-flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 0.9rem;
                                "
                                >1</span
                            >
                            Conectar o Crear tu Workspace
                        </h4>
                        <div
                            style="
                                background: #f8fafc;
                                padding: 1.25rem;
                                border-radius: 8px;
                                border: 1px solid #e2e8f0;
                            "
                        >
                            <p style="margin: 0 0 1rem 0; color: #475569">
                                <strong>Opci√≥n A:</strong> Conectar a un Sheet
                                existente
                            </p>
                            <ul
                                style="
                                    margin: 0 0 1rem 1.5rem;
                                    color: #64748b;
                                    line-height: 1.8;
                                "
                            >
                                <li>Pega la URL completa de tu Google Sheet</li>
                                <li>Click en "üìã Conectar a mi Sheet"</li>
                                <li>
                                    El sistema auto-detectar√° si necesita
                                    configuraci√≥n
                                </li>
                            </ul>
                            <p style="margin: 1rem 0 0.5rem 0; color: #475569">
                                <strong>Opci√≥n B:</strong> Crear un nuevo
                                Workspace
                            </p>
                            <ul
                                style="
                                    margin: 0 0 0 1.5rem;
                                    color: #64748b;
                                    line-height: 1.8;
                                "
                            >
                                <li>Click en "‚ú® Crear Nuevo Workspace"</li>
                                <li>
                                    El sistema crear√° autom√°ticamente un Google
                                    Sheet completo
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Paso 2 -->
                    <div style="margin-bottom: 2rem">
                        <h4
                            style="
                                font-size: 1.1rem;
                                font-weight: 700;
                                color: #1e293b;
                                margin-bottom: 1rem;
                                display: flex;
                                align-items: center;
                                gap: 0.5rem;
                            "
                        >
                            <span
                                style="
                                    background: #10b981;
                                    color: white;
                                    width: 28px;
                                    height: 28px;
                                    border-radius: 50%;
                                    display: inline-flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 0.9rem;
                                "
                                >2</span
                            >
                            Crear y Gestionar Casos
                        </h4>
                        <div
                            style="
                                background: #f8fafc;
                                padding: 1.25rem;
                                border-radius: 8px;
                                border: 1px solid #e2e8f0;
                            "
                        >
                            <ul
                                style="
                                    margin: 0 0 0 1.5rem;
                                    color: #64748b;
                                    line-height: 1.8;
                                "
                            >
                                <li>Click en "‚ûï Crear Caso"</li>
                                <li>
                                    Elige formato: <strong>Cl√°sico</strong> o
                                    <strong>Gherkin</strong>
                                </li>
                                <li>
                                    Organiza por m√≥dulos creando hojas
                                    personalizadas
                                </li>
                                <li>
                                    Marca flujos cr√≠ticos y candidatos a
                                    regresi√≥n
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Paso 3 -->
                    <div style="margin-bottom: 2rem">
                        <h4
                            style="
                                font-size: 1.1rem;
                                font-weight: 700;
                                color: #1e293b;
                                margin-bottom: 1rem;
                                display: flex;
                                align-items: center;
                                gap: 0.5rem;
                            "
                        >
                            <span
                                style="
                                    background: #f59e0b;
                                    color: white;
                                    width: 28px;
                                    height: 28px;
                                    border-radius: 50%;
                                    display: inline-flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 0.9rem;
                                "
                                >3</span
                            >
                            Ejecutar Pruebas
                        </h4>
                        <div
                            style="
                                background: #f8fafc;
                                padding: 1.25rem;
                                border-radius: 8px;
                                border: 1px solid #e2e8f0;
                            "
                        >
                            <ul
                                style="
                                    margin: 0 0 0 1.5rem;
                                    color: #64748b;
                                    line-height: 1.8;
                                "
                            >
                                <li>
                                    Click en "‚ö° Ejecutar" en cualquier caso
                                </li>
                                <li>
                                    Resultado: OK, No_OK, Bloqueado, Descartado
                                </li>
                                <li>
                                    <strong>Importante:</strong> No_OK requiere
                                    reportar un bug
                                </li>
                                <li>Adjunta evidencias (links a Drive)</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Paso 4 -->
                    <div style="margin-bottom: 2rem">
                        <h4
                            style="
                                font-size: 1.1rem;
                                font-weight: 700;
                                color: #1e293b;
                                margin-bottom: 1rem;
                                display: flex;
                                align-items: center;
                                gap: 0.5rem;
                            "
                        >
                            <span
                                style="
                                    background: #ef4444;
                                    color: white;
                                    width: 28px;
                                    height: 28px;
                                    border-radius: 50%;
                                    display: inline-flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 0.9rem;
                                "
                                >4</span
                            >
                            Reportar Bugs
                        </h4>
                        <div
                            style="
                                background: #f8fafc;
                                padding: 1.25rem;
                                border-radius: 8px;
                                border: 1px solid #e2e8f0;
                            "
                        >
                            <ul
                                style="
                                    margin: 0 0 0 1.5rem;
                                    color: #64748b;
                                    line-height: 1.8;
                                "
                            >
                                <li>
                                    Desde ejecuci√≥n No_OK, click "üêõ Reportar
                                    Bug"
                                </li>
                                <li>
                                    Completa t√≠tulo, severidad, pasos para
                                    reproducir
                                </li>
                                <li>
                                    Bug queda vinculado autom√°ticamente al caso
                                </li>
                                <li>
                                    Accede al historial con "üêõ Historial de
                                    Bugs"
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Tips -->
                    <div
                        style="
                            background: linear-gradient(
                                135deg,
                                #fef3c7 0%,
                                #fde68a 100%
                            );
                            padding: 1.5rem;
                            border-radius: 8px;
                            border-left: 4px solid #f59e0b;
                        "
                    >
                        <h4
                            style="
                                margin: 0 0 0.75rem 0;
                                color: #92400e;
                                font-size: 1rem;
                            "
                        >
                            üí° Tips
                        </h4>
                        <ul
                            style="
                                margin: 0 0 0 1.5rem;
                                color: #92400e;
                                line-height: 1.8;
                            "
                        >
                            <li><strong>ESC:</strong> Cierra modales</li>
                            <li>
                                <strong>Filtros:</strong> Se guardan
                                autom√°ticamente
                            </li>
                            <li>
                                <strong>Responsive:</strong> Vista optimizada
                                para m√≥vil
                            </li>
                            <li>
                                <strong>Accesibilidad:</strong> Navegaci√≥n por
                                teclado completa
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="modal-footer">
                    <button
                        class="btn btn-primary"
                        onclick="cerrarModal('modalGuiaInicio')"
                    >
                        <span>‚úÖ</span>
                        <span>Entendido</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- SCRIPTS GLOBALES                                                     -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <?!= include('Frontend_Scripts_Main'); ?>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- COMPONENTES - SETUP (Configuraci√≥n de Workspace)                    -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <?!= include('Frontend_Components_Setup'); ?>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- COMPONENTES - CASOS (Arquitectura Modular - 5 archivos)             -->
        <!-- ORDEN IMPORTANTE: De menos dependiente a m√°s dependiente            -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

        <!-- 1. UI - Base visual (HTML + CSS) -->
        <?!= include('Frontend_Components_Casos_UI'); ?>

        <!-- 2. Navegaci√≥n - Helpers globales y gesti√≥n de URL -->
        <?!= include('Frontend_Components_Casos_Navegacion'); ?>

        <!-- 3. Tabla - Visualizaci√≥n y filtros -->
        <?!= include('Frontend_Components_Casos_Tabla'); ?>

        <!-- 4. Hojas - Gesti√≥n de hojas/m√≥dulos -->
        <?!= include('Frontend_Components_Casos_Hojas'); ?>

        <!-- 5. CRUD - Crear, editar, eliminar, restaurar -->
        <?!= include('Frontend_Components_Casos_CRUD'); ?>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- COMPONENTES - EJECUCIONES                                            -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <?!= include('Frontend_Components_Ejecuciones'); ?>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- COMPONENTES - BUGS                                                   -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <?!= include('Frontend_Components_Bugs'); ?>
        <?!= include('Frontend_Components_Bugs_List2'); ?>
        <?!= include('Frontend_Policies'); ?>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- COMPONENTES - INTEGRACI√ìN TRELLO                                     -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <?!= include('Frontend_Components_Trello_Config'); ?>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- COMPONENTES - M√âTRICAS Y REGRESIONES                                 -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <?!= include('Frontend_Components_Metricas'); ?>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- SCRIPTS ESPEC√çFICOS DEL INDEX                                       -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <script>
            // ===================================================================
            // VARIABLES GLOBALES
            // ===================================================================

            let currentUser = null;

            // ===================================================================
            // INICIALIZACI√ìN
            // ===================================================================

            window.onload = function () {
                console.log("üöÄ Inicializando QA Management System...");
                cargarUsuario();

                // Validar que todos los m√≥dulos est√©n cargados
                setTimeout(() => {
                    validarModulosCargados();
                }, 500);
            };

            // ===================================================================
            // VALIDACI√ìN DE M√ìDULOS
            // ===================================================================

            function validarModulosCargados() {
                const modulosRequeridos = [
                    // Scripts Main
                    { nombre: "mostrarSpinner", modulo: "Scripts_Main" },
                    { nombre: "mostrarToast", modulo: "Scripts_Main" },

                    // Navegaci√≥n
                    { nombre: "irACasos", modulo: "Casos_Navegacion" },
                    {
                        nombre: "mostrarPantallaCasos",
                        modulo: "Casos_Navegacion",
                    },
                    { nombre: "recuperarSheetUrl", modulo: "Casos_Navegacion" },

                    // Tabla
                    { nombre: "cargarTodosLosCasos", modulo: "Casos_Tabla" },
                    { nombre: "renderizarTablaCasos", modulo: "Casos_Tabla" },

                    // Hojas
                    { nombre: "cargarHojasDisponibles", modulo: "Casos_Hojas" },
                    { nombre: "crearHojaNueva", modulo: "Casos_Hojas" },

                    // CRUD
                    { nombre: "verDetalleCaso", modulo: "Casos_CRUD" },
                    { nombre: "editarCaso", modulo: "Casos_CRUD" },
                    { nombre: "guardarCaso", modulo: "Casos_CRUD" },

                    // Ejecuciones
                    { nombre: "abrirModalEjecutarCaso", modulo: "Ejecuciones" },

                    // M√©tricas y Regresiones
                    { nombre: "mostrarMetricasProyecto", modulo: "Metricas" },
                    { nombre: "mostrarMetricasQA", modulo: "Metricas" },
                    { nombre: "mostrarRegresiones", modulo: "Metricas" },
                ];

                let todosCargados = true;
                let modulosFallidos = [];

                modulosRequeridos.forEach((item) => {
                    if (typeof window[item.nombre] !== "function") {
                        todosCargados = false;
                        modulosFallidos.push(item);
                        console.error(
                            "‚ùå Funci√≥n no disponible:",
                            item.nombre,
                            "del m√≥dulo",
                            item.modulo
                        );
                    }
                });

                if (todosCargados) {
                    console.log("‚úÖ Todos los m√≥dulos cargados correctamente");
                    console.log("üìä Sistema listo para usar");
                } else {
                    console.error("‚ùå Faltan m√≥dulos:", modulosFallidos);
                    mostrarToast(
                        "‚ö†Ô∏è Error: Algunos m√≥dulos no se cargaron correctamente",
                        "warning"
                    );
                }
            }

            // ===================================================================
            // FUNCIONES DE USUARIO
            // ===================================================================

            function cargarUsuario() {
                try {
                    const email = "<?= userEmail ?>" || "usuario@qa.com";

                    if (email && email !== "") {
                        currentUser = { email: email };
                        document.getElementById("userEmail").textContent =
                            email;

                        const iniciales = email.substring(0, 2).toUpperCase();
                        document.getElementById("userAvatar").textContent =
                            iniciales;

                        console.log("‚úÖ Usuario cargado:", email);
                    } else {
                        document.getElementById("userEmail").textContent =
                            "Usuario QA";
                        document.getElementById("userAvatar").textContent =
                            "QA";
                    }
                } catch (error) {
                    console.error("Error en cargarUsuario:", error);
                    document.getElementById("userEmail").textContent =
                        "Usuario QA";
                    document.getElementById("userAvatar").textContent = "QA";
                }
            }

            // ===================================================================
            // FUNCIONES DE PRUEBA
            // ===================================================================

            function testearBackend() {
                mostrarSpinner();

                google.script.run
                    .withSuccessHandler(function (response) {
                        ocultarSpinner();

                        if (response.success) {
                            const mensaje =
                                "Backend funcionando! Usuario: " +
                                response.user;
                            mostrarToast(mensaje, "success");
                            console.log("‚úÖ Test backend exitoso:", response);
                        } else {
                            mostrarToast("Error en el test", "error");
                        }
                    })
                    .withFailureHandler(function (error) {
                        ocultarSpinner();
                        mostrarToast(
                            "Error de conexi√≥n: " + error.message,
                            "error"
                        );
                    })
                    .testBackend();
            }

            /**
             * Muestra el modal de gu√≠a de inicio con instrucciones completas
             * @description Reemplaza el antiguo alert por un modal moderno e interactivo
             */
            function mostrarInfo() {
                if (typeof abrirModal === "function") {
                    abrirModal("modalGuiaInicio");
                } else {
                    // Fallback si abrirModal no est√° disponible
                    var modal = document.getElementById("modalGuiaInicio");
                    if (modal) {
                        modal.classList.add("active");
                    }
                }
            }

            // Funci√≥n para crear workspace (llama a Setup)
            function iniciarCreacionWorkspace() {
                if (typeof abrirModalNuevoWorkspace === "function") {
                    abrirModalNuevoWorkspace();
                } else {
                    mostrarToast("M√≥dulo de Setup no disponible", "error");
                }
            }

            // ===================================================================
            // MANEJO DE ERRORES GLOBALES
            // ===================================================================

            window.onerror = function (msg, url, lineNo, columnNo, error) {
                console.error(
                    "üí• Error global:",
                    msg,
                    "at",
                    lineNo + ":" + columnNo
                );
                mostrarToast("Ocurri√≥ un error inesperado", "error");
                return false;
            };

            console.log("‚úÖ Frontend_Index.html cargado");
        </script>
    </body>
</html>
